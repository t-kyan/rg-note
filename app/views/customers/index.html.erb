<%= render 'shared/header' %>
<div class="container">
  <form>
    <div class="input-group my-5 mx-auto">
      <input type="text" class="form-control" placeholder="キーワードを入力">
      <button class="btn btn-outline-success" type="button" id="button-addon2"><i class="fas fa-search"></i> 検索</button>
    </div>
  </form>
  <!-- 顧客一覧テーブル -->
  <table class="table caption-top my-5 mx-auto">
    <caption>お客様一覧</caption>
    <thead>
      <tr>
        <th scope="col">画像</th>
        <th scope="col">お名前</th>
        <th scope="col">会社名</th>
        <th scope="col">ボトル</th>
        <th scope="col">ボトル開封日</th>
        <th scope="col">経過日数</th>
        <th scope="col">担当</th>
        <th scope="col">来店日</th>
      </tr>
    </thead>
    <tbody>
      <% @customers.each do |customer| %>
        <tr>
          <td>
            <% if customer.image.attached? %>
              <%= image_tag customer.image.variant(resize: "100x100") %>
            <% end %>
          </td>
          <td><%= customer.name %></td>
          <td><%= customer.company %></td>
          <td>
            <% if customer.bottles.any? %>
              <%= customer.bottles.first.bottle_name %>
            <% end %>
          </td>
          <td>
            <% if customer.bottles.any? %>
              <%= customer.bottles.first.opening_date %>
            <% end %>
          </td>
          <td>
            <% if customer.bottles.any? %>
              <%= days_since_opening(customer.bottles.first.opening_date) %>
            <% end %>
          </td>
          <td><%= customer.server %></td>
          <td><%= customer.coming_date %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>